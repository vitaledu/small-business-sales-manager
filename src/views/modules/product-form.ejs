<div class="page-header">
  <h1><%= product ? 'âœï¸ Editar Produto' : 'â• Novo Produto' %></h1>
</div>

<form method="POST" action="<%= product ? '/produtos/' + product.id + '/editar' : '/produtos' %>" class="form-card">
  <div class="form-group">
    <label>Nome do Produto *</label>
    <input type="text" name="name" value="<%= product ? product.name : '' %>" required>
  </div>

  <div class="form-row">
    <div class="form-group">
      <label>Tipo *</label>
      <select name="type" required>
        <option value="">Selecione...</option>
        <option value="SACOLÃ‰" <%= product && product.type === 'SACOLÃ‰' ? 'selected' : '' %>>SacolÃ©</option>
        <option value="BEBIDA" <%= product && product.type === 'BEBIDA' ? 'selected' : '' %>>Bebida</option>
      </select>
    </div>

    <div class="form-group">
      <label>Origem *</label>
      <select name="origin" required>
        <option value="PRODUZIDO" <%= !product || product.origin === 'PRODUZIDO' ? 'selected' : '' %>>ğŸ­ Produzido (eu fabrico)</option>
        <option value="COMPRADO"  <%= product && product.origin === 'COMPRADO'  ? 'selected' : '' %>>ğŸ›’ Comprado (de fornecedor)</option>
      </select>
    </div>

    <div class="form-group" style="display:flex;align-items:center;padding-top:28px;">
      <label style="display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;">
        <input type="checkbox" name="isReturnable" id="isReturnable" <%= product && product.isReturnable ? 'checked' : '' %> style="width:auto;">
        RetornÃ¡vel ğŸ”„
      </label>
    </div>
  </div>

  <!-- Deposit value â€” shown only when returnable is checked -->
  <div id="deposit-group" style="display:<%= product && product.isReturnable ? 'block' : 'none' %>;">
    <div class="form-group" style="max-width:200px;">
      <label>DepÃ³sito por unidade (R$)</label>
      <input type="number" name="depositValue" id="depositValue" step="0.01" min="0"
        value="<%= product && product.depositValue ? product.depositValue : 5 %>">
      <div class="form-hint">Valor cobrado ao cliente por garrafa retornÃ¡vel</div>
    </div>
  </div>

  <div class="form-row">
    <div class="form-group">
      <label>Custo UnitÃ¡rio (R$) *</label>
      <input type="number" name="costUnit" step="0.01" value="<%= product ? product.costUnit : '' %>" required>
    </div>

    <div class="form-group">
      <label>PreÃ§o de Venda (R$) *</label>
      <input type="number" name="priceUnit" step="0.01" value="<%= product ? product.priceUnit : '' %>" required>
    </div>
  </div>

  <div class="form-group">
    <label>DescriÃ§Ã£o</label>
    <textarea name="description"><%= product ? product.description || '' : '' %></textarea>
  </div>

  <div class="form-actions">
    <a href="/produtos" class="btn btn-secondary">â† Cancelar</a>
    <button type="submit" class="btn btn-primary"><%= product ? 'ğŸ’¾ Atualizar' : 'ğŸ’¾ Criar Produto' %></button>
  </div>
</form>

<script>
document.getElementById('isReturnable').addEventListener('change', function() {
  document.getElementById('deposit-group').style.display = this.checked ? 'block' : 'none';
});
</script>
